{"version":3,"sources":["webpack:///./src/components/UserFollowCard.vue?dedb","webpack:///./src/components/UserFollowCard.vue?8ab5","webpack:///src/components/UserFollowCard.vue","webpack:///./src/components/UserFollowCard.vue?6200","webpack:///./src/components/UserFollowCard.vue?8999","webpack:///./src/views/UserFollowing.vue?0f6d","webpack:///src/views/UserFollowing.vue","webpack:///./src/views/UserFollowing.vue?6164","webpack:///./src/views/UserFollowing.vue?0500","webpack:///./src/views/UserFollowing.vue?bafc"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_t","attrs","staticRenderFns","component","_v","_e","_l","following","key","id","scopedSlots","_u","fn","_f","avatarImg","on","$event","stopPropagation","preventDefault","visit","proxy","_s","name","account","currentUser","directives","rawName","value","is_following","expression","isProcessing","follow","unfollow","introduction","components","UserFollowCard","mixins","data","followings","noFollowings","props","initialFollowings","type","required","methods","fetchUserFollowings","userAPI","statusText","Toast","icon","title","followShipAPI","user","console","pathName","computed","mapState","beforeRouteUpdate","to","from","next","created","watch","newVal"],"mappings":"2IAAA,W,oCCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACN,EAAIO,GAAG,UAAS,WAAW,MAAO,CAACH,EAAG,MAAM,CAACI,MAAM,CAAC,IAAM,EAAQ,QAA0C,IAAM,WAAU,GAAGJ,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,IAAI,CAACE,YAAY,QAAQ,CAACN,EAAIO,GAAG,SAAS,GAAGP,EAAIO,GAAG,QAAQ,GAAGH,EAAG,IAAI,CAACE,YAAY,QAAQ,CAACN,EAAIO,GAAG,SAAS,QAC7eE,EAAkB,GCoBP,KCrByU,I,wBCQpVC,EAAY,eACd,EACAX,EACAU,GACA,EACA,KACA,WACA,MAIa,OAAAC,E,kDCnBf,IAAIX,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAAC,CAAEN,EAAgB,aAAEI,EAAG,KAAK,CAACJ,EAAIW,GAAG,cAAcX,EAAIY,KAAKZ,EAAIa,GAAIb,EAAc,YAAE,SAASc,GAAW,OAAOV,EAAG,iBAAiB,CAACW,IAAID,EAAUE,GAAGC,YAAYjB,EAAIkB,GAAG,CAAC,CAACH,IAAI,SAASI,GAAG,WAAW,MAAO,CAACf,EAAG,MAAM,CAACE,YAAY,SAASE,MAAM,CAAC,IAAMR,EAAIoB,GAAG,eAAPpB,CAAuBc,EAAUO,WAAW,IAAM,IAAIC,GAAG,CAAC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBzB,EAAI0B,MAAMZ,EAAUE,GAAG,qBAAqBW,OAAM,GAAM,CAACZ,IAAI,OAAOI,GAAG,WAAW,MAAO,CAACnB,EAAIW,GAAG,IAAIX,EAAI4B,GAAGd,EAAUe,MAAM,OAAOF,OAAM,GAAM,CAACZ,IAAI,KAAKI,GAAG,WAAW,MAAO,CAACnB,EAAIW,GAAG,IAAIX,EAAI4B,GAAGd,EAAUgB,SAAS,OAAOH,OAAM,GAAM,CAACZ,IAAI,MAAMI,GAAG,WAAW,MAAO,CAACf,EAAG,MAAM,CAACE,YAAY,aAAa,CAAEQ,EAAUE,KAAOhB,EAAI+B,YAAYf,GAAI,CAACZ,EAAG,SAAS,CAAC4B,WAAW,CAAC,CAACH,KAAK,OAAOI,QAAQ,SAASC,OAAQpB,EAAUqB,aAAcC,WAAW,4BAA4B9B,YAAY,SAASE,MAAM,CAAC,SAAWR,EAAIqC,cAAcf,GAAG,CAAC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBzB,EAAIsC,OAAOxB,EAAUE,OAAO,CAAChB,EAAIW,GAAG,UAAUP,EAAG,SAAS,CAAC4B,WAAW,CAAC,CAACH,KAAK,OAAOI,QAAQ,SAASC,MAAOpB,EAAsB,aAAEsB,WAAW,2BAA2B9B,YAAY,YAAYE,MAAM,CAAC,SAAWR,EAAIqC,cAAcf,GAAG,CAAC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBzB,EAAIuC,SAASzB,EAAUE,OAAO,CAAChB,EAAIW,GAAG,YAAYP,EAAG,SAAS,CAACE,YAAY,YAAYE,MAAM,CAAC,SAAW,KAAK,CAACR,EAAIW,GAAG,aAAa,KAAKgB,OAAM,GAAM,CAACZ,IAAI,OAAOI,GAAG,WAAW,MAAO,CAACnB,EAAIW,GAAG,IAAIX,EAAI4B,GAAG5B,EAAIoB,GAAG,aAAPpB,CAAqBc,EAAU0B,eAAe,OAAOb,OAAM,IAAO,MAAK,UAAY,IACjsDlB,EAAkB,G,gKC+DP,GACfoB,qBACAY,YACAC,uBAEAC,8BACAC,KANA,WAOA,OACAC,kDACAC,gBACAT,kBAGAU,OAEAC,mBACAC,WACAC,cAGAC,SACAC,oBADA,SACApC,GAAA,oLAEA,mCAFA,SAGAqC,YAAArC,OAHA,mBAGA4B,EAHA,EAGAA,KAAAU,EAHA,EAGAA,WACAT,EAAAD,WAEA,4DAEA,aACA,kBAEA,kBAEAU,SAbA,uBAcA,aAdA,QAgBA,mCAhBA,qDAkBA,mCACAC,aACAC,aACAC,4BArBA,6DAyBAnB,OA1BA,SA0BAtB,GAAA,gLAEA,kBAFA,SAGA0C,eAAA1C,OAHA,mBAGAsC,EAHA,EAGAA,WACAA,SAJA,sBAKA,aALA,OAOA,2CACA,gBACA,EAEA,SACA,iCACAK,GADA,IAEAxB,uBAHA,KAQA,4BACAyB,+BACA,kBArBA,qDAuBA,kBACAL,aACAC,aACAC,wBA1BA,6DA8BAlB,SAxDA,SAwDAvB,GAAA,gLAEA,kBAFA,SAGA0C,iBAAA1C,OAHA,mBAGAsC,EAHA,EAGAA,WACAA,SAJA,sBAKA,aALA,OAOA,2CACA,gBACA,EAEA,SACA,iCACAK,GADA,IAEAxB,uBAHA,KAQA,4BACA,kBApBA,qDAsBA,kBACAoB,aACAC,aACAC,0BAzBA,6DA6BA/B,MArFA,SAqFAV,EAAA6C,GAEA,0BAGAC,2BACAC,iCAEAC,kBAjHA,SAiHAC,EAAAC,EAAAC,GACA,kBACA,4BACAA,KAEAC,QAtHA,WAuHA,4BACA,6BAEAC,OAEArB,kBAFA,SAEAsB,GACA,kCACA,2BACA,qBAEA,wBCjMuV,I,wBCQnV5D,EAAY,eACd,EACAX,EACAU,GACA,EACA,KACA,WACA,MAIa,aAAAC,E,2CCnBf,W","file":"js/chunk-597e428a.3faf03cc.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowCard.vue?vue&type=style&index=0&id=0a947838&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"follow__card\"},[_c('div',{staticClass:\"follow__card__item\"},[_vm._t(\"avatar\",function(){return [_c('img',{attrs:{\"src\":require(\"../assets/static/images/noImage@2x.png\"),\"alt\":\"\"}})]})],2),_c('div',{staticClass:\"follow__card__item\"},[_c('div',{staticClass:\"account\"},[_c('p',{staticClass:\"name\"},[_vm._t(\"name\")],2),_vm._t(\"btn\")],2),_c('p',{staticClass:\"text\"},[_vm._t(\"text\")],2)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"follow__card\">\n    <div class=\"follow__card__item\">\n      <slot name=\"avatar\">\n        <img src=\"../assets/static/images/noImage@2x.png\" alt=\"\">\n      </slot>\n    </div>\n    <div class=\"follow__card__item\">\n      <div class=\"account\">\n        <p class=\"name\"><slot name=\"name\"></slot></p>\n        <slot name=\"btn\"></slot>\n      </div>\n      <p class=\"text\">\n        <slot name=\"text\" ></slot>\n      </p>    \n    </div>    \n  </div>\n  \n</template>\n<script>\n\nexport default {\n  \n  \n}\n</script>\n\n<style lang=\"scss\" scoped>\n  @import \"../assets/scss/_basic.scss\";\n   .follow__card{\n    display: flex;\n    padding: 16px;\n    border-bottom: 1px solid $border-grey;\n    .avatar{\n        width: 50px;\n        height: 50px;\n        border-radius: 50%;\n    }\n    &__item:nth-child(2){\n      padding-left: 10px;\n    }\n    &__item{\n      line-height:26px;\n      \n      .account{\n        display: flex;\n        align-items: center;\n        vertical-align: sub;\n        padding-bottom: 10px;\n        margin-top: 10px;\n        \n        .name{\n          @extend %tweet-name; \n          margin-right: 8px;        \n        }\n      }\n      .text {\n        word-break: break-all;\n      }\n    }\n  }\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowCard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowCard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserFollowCard.vue?vue&type=template&id=0a947838&scoped=true&\"\nimport script from \"./UserFollowCard.vue?vue&type=script&lang=js&\"\nexport * from \"./UserFollowCard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserFollowCard.vue?vue&type=style&index=0&id=0a947838&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0a947838\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"follower-container\"},[[(_vm.noFollowings)?_c('h3',[_vm._v(\"尚未追蹤其他用戶\")]):_vm._e(),_vm._l((_vm.followings),function(following){return _c('UserFollowCard',{key:following.id,scopedSlots:_vm._u([{key:\"avatar\",fn:function(){return [_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm._f(\"avatarFilter\")(following.avatarImg),\"alt\":\"\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.visit(following.id,'user-tweets')}}})]},proxy:true},{key:\"name\",fn:function(){return [_vm._v(\" \"+_vm._s(following.name)+\" \")]},proxy:true},{key:\"id\",fn:function(){return [_vm._v(\" \"+_vm._s(following.account)+\" \")]},proxy:true},{key:\"btn\",fn:function(){return [_c('div',{staticClass:\"btn-group\"},[(following.id !== _vm.currentUser.id)?[_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(!following.is_following),expression:\"!following.is_following\"}],staticClass:\"follow\",attrs:{\"disabled\":_vm.isProcessing},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.follow(following.id)}}},[_vm._v(\" 跟隨 \")]),_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(following.is_following),expression:\"following.is_following\"}],staticClass:\"following\",attrs:{\"disabled\":_vm.isProcessing},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.unfollow(following.id)}}},[_vm._v(\"正在跟隨 \")])]:_c('button',{staticClass:\"following\",attrs:{\"disabled\":\"\"}},[_vm._v(\" 用戶本人 \")])],2)]},proxy:true},{key:\"text\",fn:function(){return [_vm._v(\" \"+_vm._s(_vm._f(\"textFilter\")(following.introduction))+\" \")]},proxy:true}],null,true)})})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"follower-container\">\n    <template>\n      <h3 v-if=\"noFollowings\">尚未追蹤其他用戶</h3>\n      <template>\n        <UserFollowCard\n          v-for=\"following in followings\"\n          :key=\"following.id\"\n        >\n          <template v-slot:avatar>\n            <img \n              @click.stop.prevent=\"visit(following.id,'user-tweets')\"\n              class=\"avatar\" :src=\"following.avatarImg | avatarFilter\" alt=\"\">\n          </template>\n          <template v-slot:name>\n            {{following.name}}\n          </template>\n          <template v-slot:id>\n            {{following.account}}\n          </template>\n          <template v-slot:btn>\n            <div class=\"btn-group\">\n              <template  \n                v-if=\"following.id !== currentUser.id\" \n              >\n                <button \n                  :disabled=\"isProcessing\"\n                  @click.stop.prevent=\"follow(following.id)\"\n                  v-show=\"!following.is_following\" class=\"follow\"\n                >\n                  跟隨\n                </button>\n                <button \n                  :disabled=\"isProcessing\"\n                  @click.stop.prevent=\"unfollow(following.id)\"\n                  v-show=\"following.is_following\" class=\"following\">正在跟隨\n                </button>\n              </template>            \n              <button \n                v-else\n                disabled\n                class=\"following\">\n                用戶本人\n              </button>\n            </div>       \n          </template>\n          <template v-slot:text>\n            {{following.introduction| textFilter}}\n          </template>\n        </UserFollowCard>\n      </template>\n    </template>  \n  </div>\n  \n</template>\n<script>\nimport {imgFilter} from '../utils/mixins'\nimport {mapState} from 'vuex'\nimport followShipAPI from '../apis/followShip'\nimport UserFollowCard from '../components/UserFollowCard.vue'\nimport {visitPage} from '../utils/mixins'\nimport {textFilter} from '../utils/mixins'\nimport userAPI from '../apis/user'\nimport {Toast} from '../utils/helpers'\nexport default {\n  name:'UserFollowing',\n  components:{\n    UserFollowCard,\n  }, \n  mixins: [textFilter, visitPage, imgFilter],\n  data(){\n    return{\n      followings:[...this.initialFollowings],\n      noFollowings: false,\n      isProcessing: false,\n    }\n  },\n  props: {\n    // 點擊 Popular 追蹤/取消追蹤後更新的資料\n    initialFollowings: {\n      type: Array,\n      required: true\n    }\n  },\n  methods:{\n    async fetchUserFollowings(id){\n      try{\n        this.$store.commit(\"setIsLoading\", true);\n        const {data, statusText} = await userAPI.get({id})\n        const followings = data.Follower\n        // 篩除非user的用戶\n        this.followings = followings.filter( follower => follower.role === 'user')\n        // this.$store.commit('setUserFollowing',this.followings)\n        if(followings.length === 0){\n          this.noFollowings = true\n        }else {\n          this.noFollowings = false\n        }\n        if(statusText !== 'OK'){\n          throw new Error(statusText)\n        }\n        this.$store.commit(\"setIsLoading\", false);\n      }catch(error){\n        this.$store.commit(\"setIsLoading\", false);\n        Toast.fire({\n          icon:'error',\n          title: '無法取得追蹤中用戶資料，請稍後再試'\n        })\n      }\n    },\n    async follow(id){\n      try{\n        this.isProcessing = true\n        const {statusText} = await followShipAPI.follow({id})\n        if(statusText !=='OK'){\n          throw new Error(statusText)\n        }\n        this.followings = this.followings.map(user => {\n          if(user.id !== id) {\n            return user\n          }\n          if(user.id === id) {\n            return{\n              ...user,\n              is_following: true\n            }\n          }\n        })\n        // 當點擊追蹤時，emit 回 UserFollow，讓 UserFollow 去 fetchTopUsers 打 API 更新 topUsers\n        this.$emit('after-userfollow')\n        console.log('afterUserFollow')\n        this.isProcessing = false\n      }catch(error){\n        this.isProcessing = false\n        Toast.fire({\n          icon:'error',\n          title:'無法追蹤此用戶，請稍後再試'\n        })\n      }       \n    },\n    async unfollow(id){  \n      try{\n        this.isProcessing = true\n        const {statusText} = await followShipAPI.unFollow({id})\n        if(statusText !== 'OK'){\n          throw new Error (statusText)\n        }\n        this.followings = this.followings.map(user => {\n          if(user.id !== id) {\n            return user\n          }\n          if(user.id === id) {\n            return{\n              ...user,\n              is_following: false\n            }\n          }\n        })\n        // 同上\n        this.$emit('after-userfollow')\n        this.isProcessing = false\n      }catch(error){\n        this.isProcessing = false\n        Toast.fire({\n          icon:'error',\n          title:'無法取消追蹤此用戶，請稍後再試'\n        })\n      }       \n    },  \n    visit(id,pathName){\n      //使用mixins裡的函式\n      this.visitUserPage(id,pathName)\n    }\n  },\n  computed:{\n    ...mapState(['currentUser'])\n  },\n  beforeRouteUpdate(to, from, next){\n    const {id} = to.params\n    this.fetchUserFollowings(id)\n    next()\n  },\n  created(){\n    const {id} = this.$route.params\n    this.fetchUserFollowings(id)\n  },\n  watch: {\n    // 當 initialFollowings 有更新，就重新賦值給 followings\n    initialFollowings(newVal) {\n      this.followings = [...newVal]\n      if (this.followings.length === 0) {\n        this.noFollowings = true\n      } else {\n        this.noFollowings = false\n      }      \n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n  @import \"../assets/scss/_basic.scss\";\n  .follower-container{\n    position: relative;\n    height: 100vh;\n    overflow-y: scroll;\n  }\n  .btn-group{\n    position: absolute;\n    right: 30px;\n    .follow{\n      @extend %follow;\n    }\n    .following{\n      @extend %following;\n    }\n  }\n  h3{\n    text-align: center;\n    margin-top: 1rem;\n  }    \n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowing.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowing.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserFollowing.vue?vue&type=template&id=679c9a19&scoped=true&\"\nimport script from \"./UserFollowing.vue?vue&type=script&lang=js&\"\nexport * from \"./UserFollowing.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserFollowing.vue?vue&type=style&index=0&id=679c9a19&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"679c9a19\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowing.vue?vue&type=style&index=0&id=679c9a19&lang=scss&scoped=true&\""],"sourceRoot":""}